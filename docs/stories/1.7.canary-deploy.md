# Story 1.7: Create Canary Page and Deploy to DigitalOcean

## Status
Ready for Deployment

## Story
**As a** developer,
**I want** a simple "Hello World" page deployed to DigitalOcean App Platform,
**so that** I verify the entire development-to-deployment pipeline works.

## Acceptance Criteria
1. Canary page displays "Vibe Translator Machine" with pastel horror styling
2. Page shows "Coming Soon" message with example vibe text
3. Production build completes successfully (`npm run build`)
4. DigitalOcean App Platform project created and configured
5. Static site deployed from GitHub repository
6. Public URL accessible and displays canary page correctly
7. Deployment takes <5 minutes from push to live

## Tasks / Subtasks
- [x] Create canary page component (AC: 1, 2)
  - [x] Create `src/components/CanaryPage.tsx`
  - [x] Add pastel horror styled header: "Vibe Translator Machine"
  - [x] Add "Coming Soon" message with tagline
  - [x] Add 3 example vibe descriptions
  - [x] Style with pastel horror colors and fonts
  - [x] Update App.tsx to show CanaryPage
- [x] Verify production build (AC: 3)
  - [x] Run `npm run build`
  - [x] Check build output in `dist/` directory (40.20 kB CSS, 223.15 kB JS)
  - [x] Verify no TypeScript errors
  - [x] Verify no build warnings
  - [x] Build succeeded in 500ms
- [ ] Set up DigitalOcean App Platform (AC: 4)
  - [ ] Log in to DigitalOcean account
  - [ ] Create new App Platform project
  - [ ] Connect GitHub repository
  - [ ] Configure build settings (Vite static site)
  - [ ] Set environment variables (if needed)
- [ ] Configure deployment settings (AC: 5)
  - [ ] Set build command: `npm run build`
  - [ ] Set output directory: `dist`
  - [ ] Set Node version: 18 or 20
  - [ ] Enable auto-deploy on push to main
  - [ ] Review and create app
- [ ] Deploy and verify (AC: 6)
  - [ ] Trigger initial deployment
  - [ ] Monitor build logs for errors
  - [ ] Wait for deployment to complete
  - [ ] Visit public URL
  - [ ] Verify canary page renders correctly
  - [ ] Test on mobile device (bonus)
- [ ] Measure deployment time (AC: 7)
  - [ ] Time from git push to live URL
  - [ ] Should be <5 minutes total
  - [ ] Document actual time in completion notes

## Dev Notes

### Canary Page Component Template
```tsx
// src/components/CanaryPage.tsx
import { FC } from 'react'
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card'

export const CanaryPage: FC = () => {
  const exampleVibes = [
    "rainy Sunday morning after a breakup",
    "my code finally compiled",
    "dancing in an abandoned mall",
  ]

  return (
    <div className="min-h-screen bg-horror-butter flex items-center justify-center p-8">
      <Card className="max-w-2xl w-full bg-horror-peach/30 border-2 border-horror-shadow">
        <CardHeader>
          <CardTitle className="text-5xl font-mono text-horror-charcoal text-center mb-4">
            Vibe Translator Machine
          </CardTitle>
          <p className="text-xl text-horror-shadow text-center font-sans">
            Coming Soon
          </p>
        </CardHeader>
        <CardContent className="space-y-6">
          <p className="text-horror-charcoal text-center text-lg">
            Translating emotional vibes into playable music using AI.
          </p>
          
          <div className="bg-horror-mint/20 p-6 rounded-lg border border-horror-sage">
            <h3 className="font-mono text-horror-charcoal mb-3">
              Example Vibes:
            </h3>
            <ul className="space-y-2">
              {exampleVibes.map((vibe, idx) => (
                <li 
                  key={idx} 
                  className="text-horror-shadow font-sans italic pl-4 border-l-2 border-horror-coral"
                >
                  "{vibe}"
                </li>
              ))}
            </ul>
          </div>

          <p className="text-center text-sm text-horror-shadow">
            Built for the Dumb Things AI Hackathon
          </p>
        </CardContent>
      </Card>
    </div>
  )
}
```

### App.tsx Update
```tsx
// src/App.tsx
import { CanaryPage } from './components/CanaryPage'

function App() {
  return <CanaryPage />
}

export default App
```

### DigitalOcean App Platform Configuration
From PRD:
- **Primary Target**: DigitalOcean App Platform (hackathon sponsor)
- **Backup**: Vercel or Netlify (if DO has issues)
- **Static Site**: No backend needed

### Build Settings for DigitalOcean
```yaml
# App Platform Settings
name: vibe-translator-machine
region: nyc

static_sites:
  - name: web
    github:
      repo: <username>/aimusic
      branch: main
    build_command: npm run build
    output_dir: dist
    environment_slug: node-js
    node_version: 20
    routes:
      - path: /
```

### Environment Variables (if needed)
For canary page, no env vars needed yet. For production:
- `VITE_REPLICATE_API_TOKEN` (Story 2.x)

### Deployment Checklist
1. GitHub repository pushed and up-to-date
2. README.md includes project description
3. Production build succeeds locally
4. DigitalOcean account created/logged in
5. Payment method added (free tier or paid)
6. App Platform project created
7. GitHub connection authorized

### Common DigitalOcean Issues
**Issue**: Build fails with missing dependencies
- **Fix**: Ensure `package.json` has all dependencies (not devDependencies)

**Issue**: 404 on routes
- **Fix**: Add fallback route for SPA: all routes â†’ `/index.html`

**Issue**: Environment variables not working
- **Fix**: Use `VITE_` prefix, set in App Platform settings

### Alternative Deployment (Backup)
If DigitalOcean has issues:

**Vercel**:
```bash
npm install -D vercel
npx vercel --prod
```

**Netlify**:
```bash
npm install -D netlify-cli
npx netlify deploy --prod --dir=dist
```

### Post-Deployment Tasks
1. Update README.md with live URL
2. Test deployment on different devices
3. Add deployment URL to hackathon submission
4. Set up domain (if available)
5. Enable HTTPS (should be automatic)

### Canary Page Visual Requirements
From PRD:
- **Pastel Horror Aesthetic**: Soft colors, slightly unsettling
- **Typography**: Monospace for title, sans-serif for body
- **Layout**: Centered card, clear hierarchy
- **Examples**: Show what the app will do
- **Branding**: Include hackathon reference

### Success Metrics
- [ ] Public URL accessible from any device
- [ ] Page loads in <3 seconds
- [ ] Pastel horror colors render correctly
- [ ] Mobile responsive (bonus)
- [ ] No console errors
- [ ] HTTPS enabled

### Documentation Updates
After deployment, update:
1. **README.md**: Add "Live Demo" section with URL
2. **GitHub About**: Set website URL
3. **Commit Message**: `feat: deploy canary page to DigitalOcean`

## Testing
Validation through:
1. `npm run build` completes successfully
2. `npm run preview` shows canary page locally
3. DigitalOcean build logs show success
4. Public URL loads canary page
5. Page displays correct content and styling
6. Mobile browser test (if available)
7. Lighthouse score >90 for Performance (bonus)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-25 | 0.1 | Initial story creation from PRD Epic 1 | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
claude-sonnet-4-5-20250929

### Debug Log References
None - no issues encountered

### Completion Notes List
- Created CanaryPage component with pastel horror styling
- Component features:
  - Large "Vibe Translator Machine" heading with monospace font
  - "Coming Soon" card with project description
  - 3 example vibe cards: "Rainy Sunday Morning", "Abandoned Carnival", "Late Night Coding Flow"
  - All styled with horror-mint, horror-lavender, horror-peach, horror-sage backgrounds
  - Proper shadcn/ui Card components for consistent design
- Updated App.tsx to display CanaryPage
- Verified production build succeeds (500ms)
- Build output: 40.20 kB CSS, 223.15 kB JS (optimized and minified)
- TypeScript validation: 0 errors
- ESLint validation: passes

### File List
**Created:**
- `src/components/CanaryPage.tsx` - Canary landing page component

**Modified:**
- `src/App.tsx` - Updated to show CanaryPage instead of ComponentShowcase
- `docs/stories/1.7.canary-deploy.md` - Updated status and tasks

### Deployment Instructions
Canary page is ready for deployment. User needs to:
1. Create DigitalOcean App Platform project
2. Connect to GitHub repository: https://github.com/joshleichtung/vibe-translator
3. Configure build settings:
   - Build Command: `npm run build`
   - Output Directory: `dist`
   - Node Version: 20.x
4. Enable auto-deploy on push to main
5. Deploy and verify at public URL

Estimated deployment time: 3-5 minutes from push to live

## QA Results
_To be populated by QA agent_
