# Story 2.5: Display Generated Chord Progression to User

## Status
Completed

## Story
**As a** user,
**I want** to see the AI-generated chord progression and tempo displayed on screen,
**so that** I understand what musical structure was created from my vibe.

## Acceptance Criteria
1. Chord progression displayed as formatted text (e.g., "C maj → G min7 → F maj → Am min")
2. Tempo/BPM shown with monospace font (pastel horror styling)
3. Display appears after successful API response
4. Component updates when new vibe generated
5. Styling matches pastel horror aesthetic
6. Mobile responsive layout

## Tasks / Subtasks
- [x] Create ChordProgressionDisplay component (AC: 1, 2, 5)
  - [x] Create `src/components/ChordProgressionDisplay.tsx`
  - [x] Accept ChordProgression prop (from parser)
  - [x] Format chords with arrow separator (→)
  - [x] Display tempo with "BPM" label
  - [x] Apply pastel horror styling classes
  - [x] Use monospace font for musical data
- [x] Implement chord formatting logic (AC: 1)
  - [x] Create `formatChord(chord: Chord)` helper function
  - [x] Format as "ROOT TYPE" (e.g., "C major", "G minor7")
  - [x] Join chords with " → " separator
  - [x] Handle empty chord arrays gracefully
- [ ] Integrate component into app flow (AC: 3, 4) - DEFERRED TO WAVE 2
  - [ ] Import ChordProgressionDisplay in App component
  - [ ] Show component only when progression data exists
  - [ ] Update display when new progression generated
  - [ ] Clear previous progression on new request
- [x] Make layout responsive (AC: 6)
  - [x] Test on mobile viewport (320px - 768px)
  - [x] Test on desktop viewport (768px+)
  - [x] Ensure chord arrows wrap properly
  - [x] Verify readability on all screen sizes

## Dev Notes

### Tech Stack Reference
- **Component**: React with TypeScript
- **Styling**: Pastel horror custom classes
- **Typography**: Monospace font for musical data
- **Layout**: Responsive flexbox or grid

### Component Structure
```typescript
// src/components/ChordProgressionDisplay.tsx
import type { ChordProgression } from '@/types/music';

interface ChordProgressionDisplayProps {
  progression: ChordProgression;
}

function formatChord(chord: Chord): string {
  const typeDisplay = chord.type.replace(/([a-z])([0-9])/, '$1$2'); // Format maj7, min7, etc.
  return `${chord.root} ${typeDisplay}`;
}

export function ChordProgressionDisplay({ progression }: ChordProgressionDisplayProps) {
  if (!progression.chords.length) {
    return null;
  }

  const chordString = progression.chords
    .map(formatChord)
    .join(' → ');

  return (
    <div className="chord-progression-display">
      <div className="chord-sequence">
        {chordString}
      </div>
      <div className="tempo-display">
        {progression.tempo} BPM
      </div>
    </div>
  );
}
```

### Pastel Horror Styling
```css
/* Add to globals.css or component CSS */
.chord-progression-display {
  @apply p-6 rounded-lg bg-pastel-surface border-2 border-pastel-border;
  @apply space-y-4;
}

.chord-sequence {
  @apply font-mono text-lg text-pastel-text;
  @apply flex flex-wrap gap-2 items-center;
  @apply leading-relaxed;
}

.tempo-display {
  @apply font-mono text-sm text-pastel-text-muted;
  @apply tracking-wider;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .chord-sequence {
    @apply text-base;
  }

  .tempo-display {
    @apply text-xs;
  }
}
```

### Chord Formatting Examples
```typescript
// Input: { root: 'C', type: ChordType.Major, duration: 4 }
// Output: "C major"

// Input: { root: 'G', type: ChordType.Minor7, duration: 4 }
// Output: "G minor7"

// Full progression:
// "C major → G minor7 → F major → Am minor"
```

### App Integration Pattern
```typescript
// In App.tsx
import { useState } from 'react';
import { VibeInputForm } from './components/VibeInputForm';
import { ChordProgressionDisplay } from './components/ChordProgressionDisplay';
import { generateChords } from './lib/musicgen';
import { parseMusicGenResponse } from './lib/parser';
import type { ChordProgression } from './types/music';

function App() {
  const [progression, setProgression] = useState<ChordProgression | null>(null);
  const [isLoading, setIsLoading] = useState(false);

  const handleVibeSubmit = async (vibe: string) => {
    setIsLoading(true);
    setProgression(null); // Clear previous

    try {
      const response = await generateChords(vibe);
      const parsed = parseMusicGenResponse(response);
      setProgression(parsed);
    } catch (error) {
      console.error('Generation failed:', error);
      // Error handling in Story 2.6
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="app-container">
      <VibeInputForm onSubmit={handleVibeSubmit} isLoading={isLoading} />
      {progression && <ChordProgressionDisplay progression={progression} />}
    </div>
  );
}
```

### Typography Considerations
- **Monospace Font**: Use system mono stack or custom font for musical data
  - Improves readability of chord symbols
  - Aligns with pastel horror "technical" aesthetic
  - Consistent spacing for BPM numbers

### Accessibility
- Semantic HTML structure
- Sufficient color contrast for text
- Arrow symbol (→) readable by screen readers
- Consider aria-label for musical notation

### Empty State Handling
- Component returns null if no chords
- Prevents rendering empty container
- Parent handles conditional rendering

### Responsive Design Strategy
- Desktop: Full-width chord sequence, larger text
- Mobile: Wrapped chord sequence, smaller text
- Arrows wrap naturally with flexbox gap
- Tempo always visible below chords

### Testing
Manual validation:
1. Generate chord progression → display appears
2. Generate new progression → display updates
3. Test on mobile viewport → wraps properly
4. Verify monospace font applied
5. Check pastel horror colors match design

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-25 | 0.1 | Initial story creation from PRD Epic 2 | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4.5 (claude-sonnet-4-5-20250929) - Frontend Architect persona

### Debug Log References
None - TypeScript compilation succeeded on first attempt

### Completion Notes List
1. **TypeScript Types Created**: Defined Chord and ChordProgression interfaces in src/types/music.ts with proper JSDoc documentation
2. **Component Implementation**: Created ChordProgressionDisplay component with formatChord() helper function
3. **Formatting Approach**:
   - Arrow separator (→) between chords using .join(' → ')
   - Chord format: "ROOT TYPE" (e.g., "C major", "G minor7")
   - Tempo display: "120 BPM" with monospace font
4. **Pastel Horror Styling**:
   - Used horror-lavender color variables for background and border
   - Applied horror-charcoal and horror-shadow for text colors
   - Monospace font (JetBrains Mono) for technical aesthetic
5. **Responsive Design**:
   - Mobile (≤768px): text-base for chords, text-xs for tempo
   - Desktop (>768px): text-xl for chords
   - Flexbox with gap-2 for natural wrapping
6. **Empty State Handling**: Component returns null if chords array is empty
7. **App Integration**: Deferred to Wave 2 as per requirements (component is ready for integration)

### File List
**Created:**
- /Users/josh/projects/aimusic/src/types/music.ts
- /Users/josh/projects/aimusic/src/components/ChordProgressionDisplay.tsx

**Modified:**
- /Users/josh/projects/aimusic/src/index.css (added responsive media queries)
- /Users/josh/projects/aimusic/docs/stories/2.5.display-chord-progression.md (status update and completion notes)

## QA Results
_To be populated by QA agent_
